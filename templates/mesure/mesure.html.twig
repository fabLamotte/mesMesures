{% extends 'base2.html.twig' %}

{% block title %}Mesmesures | Mesures{% endblock %}

{% block stylesheets %}
    <style>
        .border-style { border-radius:10px; box-shadow: 4px 1px 8px 5px #bdbdbd; }

        .listing { display:flex; justify-content:center; flex-wrap:wrap; }
        .card { width:15%; height:370px; margin:20px; padding: 10px; }
        .card .card-title { text-align:center; border-bottom:0.5px solid grey; text-transform:uppercase; font-weight:bold; }
        .card .card-img img { width:100%; height:250px; margin-top:10px; }
        .card .card-description { text-align:center; }

        .nouvelleMesure { width:100%; height: 420px; display:flex; justify-content:center; }
        .nouvelleMesure div { width:20%; padding:5px; }
        .nouvelleMesure .title { width:97%; text-align:center; border-bottom:1px solid grey; }
        .nouvelleMesure .form { width:100%; }
        .nouvelleMesure .form h2 { font-size: 13px; }
        .nouvelleMesure .submit{ display:flex; justify-content:end; width:90%; }
        .nouvelleMesure .submit button{ border:1px solid grey; padding:10px 15px 10px 15px; cursor:pointer; background:white; border-radius:5px; box-shadow:3px 3px 10px grey; 
                                        transition: background 0.1s ease; }
        .nouvelleMesure .submit button:hover{ background:#e4e4e4; }
        svg path, svg rect{ fill: #FF6700 ;}
    </style>
{% endblock %}
{% block body %}
    <div class="listing">
        {% for mesure in mesures %}
            <div class="card border-style">
                <div class="card-title">{{ mesure.name }}</div>
                <div class="card-img"><img src="{{ mesure.image }}" title="mesure-{{ mesure.name }}" alt="mesure-{{ mesure.name }}" /></div>
                <div class="card-description">{{ mesure.description }}</div>
            </div>
        {% endfor %}
    </div>
    <div class="nouvelleMesure"> 
        <div class="border-style">
            <div class="title"><h2>Nouvelles mesures</h2></div>
            <div class="form">
                <div style="display:flex; justify-content: space-between; width:90%;"><h2>Bras</h2><input type="text" class="bras" /></div>
                <div style="display:flex; justify-content: space-between; width:90%;"><h2>Ventre</h2><input type="text" class="ventre" /></div>
                <div style="display:flex; justify-content: space-between; width:90%;"><h2>Hanches</h2><input type="text" class="hanches" /></div>
                <div style="display:flex; justify-content: space-between; width:90%;"><h2>Cuisses</h2><input type="text" class="cuisses" /></div>
                <div style="display:flex; justify-content: space-between; width:90%;"><h2>Genou</h2><input type="text" class="genou" /></div>
                <div class="target-message-form"></div>
                <div class="submit"><button type="submit" class="submit-form">Enregistrer</button></div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}

    <script src="{{ asset('js/jquery.js') }}" type="text/javascript">
    </script>
    <script  type="text/javascript">
        $('.submit-form').click(function(){
            // Variables
            var bras = $('input.bras').val();
            var ventre = $('input.ventre').val();
            var hanches = $('input.hanches').val();
            var cuisses = $('input.cuisses').val();
            var genou = $('input.genou').val();
            var load = '<div id="bar-load" class="loader loader--style6" title="5"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"width="24px" height="30px" viewBox="0 0 24 30" style="enable-background:new 0 0 50 50;" xml:space="preserve"><rect x="0" y="13" width="4" height="5" fill="#333"><animate attributeName="height" attributeType="XML"values="5;21;5" begin="0s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="y" attributeType="XML"values="13; 5; 13"begin="0s" dur="0.6s" repeatCount="indefinite" /></rect><rect x="10" y="13" width="4" height="5" fill="#333"><animate attributeName="height" attributeType="XML"values="5;21;5" begin="0.15s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="y" attributeType="XML"values="13; 5; 13"begin="0.15s" dur="0.6s" repeatCount="indefinite" /></rect><rect x="20" y="13" width="4" height="5" fill="#333"><animate attributeName="height" attributeType="XML"values="5;21;5" begin="0.3s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="y" attributeType="XML"values="13; 5; 13"begin="0.3s" dur="0.6s" repeatCount="indefinite" /></rect></svg></div>';


            // Appel ajax
            $.ajax({
                type:"POST",
                url:"{{ path('ajout_mesure_ajax') }}",
                data: { bras:bras, ventre:ventre, hanches:hanches, cuisses:cuisses, genou:genou }, 
                dataType:'json',
                beforeSend: function(){
                    // Lancement de l'animation
                    $('.submit button').hide();
                    $('.submit').append(load);
                },
                success: function(response){
                    // Fermeture de l'animation
                    $(document).find('#bar-load').remove();
                    $('.submit button').show();

                    // Affichage du message de vérification du formulaire
                    if(response === "good"){
                        $('.target-message-form').empty();
                        $('.target-message-form').css({"color":"green", "width":"90%", "text-align":"center"});
                        $('.target-message-form').append('Les mesures ont été enregistrées avec succès');
                    } else if (response === 'error') {
                        $('.target-message-form').empty();
                        $('.target-message-form').css({"color":"red", "width":"90%", "text-align":"center"});
                        $('.target-message-form').append('Certains champs sont vides ou mal renseignés');
                    }
                }
            });
        });
    </script>

{% endblock %}
